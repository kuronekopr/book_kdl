# Gemini 自動化ワークフロー実装計画書

このドキュメントは、Claude Code（または自動化エージェント）が実行するための、Geminiを使用したドキュメント処理およびスプレッドシート集計の自動化設計図です。

## 概要
Google Drive上のDOCXファイルを順次読み込み、GeminiのWebインターフェースを通じて「コンサル風の要約」を実行し、出力されたスプレッドシートのデータをマスターファイル（`KDL_20260115`）に集約します。

## 1. 前提条件と環境
- **OS**: Windows
- **対象ブラウザ**: Google Chrome (またはGeminiが開かれているブラウザ)
- **入力ソース**: `Google Drive/My Drive/book_kdl` フォルダ内の `.docx` ファイル
- **出力先**: `KDL_20260115` という名称のスプレッドシート（またはExcelファイル）
- **ツール**: ブラウザ操作およびGUI操作が可能なライブラリ（Pythonの `pyautogui`, `selenium`, `pywinauto` 等を想定）

## 2. 処理詳細フロー

### Step 1: 初期セットアップ
1. **Geminiウィンドウのアクティブ化**
   - ブラウザで既に開かれているGeminiのタブまたはウィンドウを最前面に表示します。
   - タイトル判別: "Gemini" を含むウィンドウを探してフォーカスします。

2. **ファイルリストの取得**
   - 指定パス（`Google Drive/My Drive/book_kdl`）内の拡張子 `.docx` のファイル一覧を取得します。

### Step 2: ファイル反復処理（各ファイルに対して実行）
取得したファイルリストの順序に従い、以下の操作をループ実行します。

1. **Gemini操作: コンテキスト設定**
   - **Gem選択**: 画面上の「コンサル風の文章の要約」Gemボタン（または保存されたプロンプト）をクリックします。
   - **テキスト入力**: 
     - WebのURL入力テキストボックス（またはプロンプト入力欄）にフォーカスします。
     - 文字列 `'GEM'` を入力し、`ENTER` キーを押下します。

2. **Gemini操作: ファイルアップロード**
   - プロンプト入力欄にある **「＋」（ファイルをアップロード）** ボタンをクリックします。
   - 表示されたメニューから「ファイルをアップロード」を選択します。
   - **ファイル選択ダイアログ操作**:
     - ファイル名入力ボックスに、現在の処理対象ファイルのフルパスをセットします。
     - 「開く」ボタンを押下してアップロードを実行します。

3. **Gemini操作: 実行**
   - 入力欄の **「→」（送信/実行）** ボタンを押下します。
   - 処理完了を待機します（応答が生成され、「スプレッドシートを開く」ボタンが表示されるまで）。

4. **結果のエクスポート**
   - 生成された回答の下部にある **「スプレッドシートを開く」** ボタンを探してクリックします。
   - **ポップアップ確認**: 「スプレッドシートを作成」等の確認ダイアログが表示された場合、「スプレッドシートを開く」を選択・クリックします。

### Step 3: データ集計処理
1. **生成されたスプレッドシートの操作**
   - 新しく開かれたスプレッドシートのタブ/ウィンドウにフォーカスを移動します。
   - **データコピー**:
     - 2行目から最終行まで、A列から必要な列の範囲を選択します。
     - データをコピーします（Ctrl+C）。

2. **マスターシートへの貼り付け**
   - 集計用スプレッドシート **`KDL_20260115`** をアクティブにします。
   - **貼り付け位置の特定**:
     - データが入っている最終行の**次の行**（空行）を選択します。
   - **値貼り付け**:
     - コピーしたデータを「値のみ貼り付け」（Paste Values）します。

3. **後処理**
   - 生成された一時スプレッドシート（Step 3-1で開いたもの）を閉じます。
   - 次のファイルの処理へ移行します。

## 3. 注意事項
- **待機時間**: ファイルアップロードやGeminiの生成処理、スプレッドシートの起動には時間がかかるため、適切なWait処理（待機）または画像認識による状態確認を組み込むことを推奨します。
- **エラーハンドリング**: スプレッドシート生成に失敗した場合や、ボタンが見つからない場合の再試行またはスキップ処理を検討してください。

---
**次のアクション**: 
この設計図に基づき、Claude Codeにて具体的な自動化スクリプト（Python等）を実装・実行してください。
